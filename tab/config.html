<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Tab Config</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" />
    <script src='https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js'></script>
    <script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
</head>

<body>
    <h1>Configuration for Configuable Tab</h1>
    <h2>This page is showed in Adding Tab.</h2>
    <h3>Press Save to create a tab.</h3>

    <script>
        $(document).ready(() => {
            microsoftTeams.initialize();
            microsoftTeams.settings.registerOnSaveHandler(saveEvent => {
                microsoftTeams.settings.setSettings({
                    suggestedDisplayName: "Configuable Tab",
                    contentUrl: createTabUrl(),
                    entityId: "tutorial123",
                    websiteUrl: createTabUrl(),
                });
                saveEvent.notifySuccess();
            });
            microsoftTeams.settings.setValidityState(true);
        });

        const createTabUrl = () => {
            return window.location.protocol + "//" + window.location.host + "/tab/created.html";
        }
    </script>
</body>

</html>